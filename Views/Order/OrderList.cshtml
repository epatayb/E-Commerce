@model List<Order>

    @{
    Layout = "_AccountLayout";
    ViewData["Title"] = "Siparişlerim";
    }

    @section Bar {
    <li class="breadcrumb-item">
        Siparişler
    </li>
    }


    <section class="mt-3">
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                    @await Html.PartialAsync("Partials/Account/_AccountSideBar")
                </div>
                <div class="col-9">
                    <div class="card shadow">
                        <div class="card-header py-1">
                            <h5 class="card-title mb-0">Siparişlerim</h5>
                        </div>
                        <div class="card-body">
                            @if(Model.Count == 0)
                            {
                            <div class="alert alert-warning">
                                Siparişiniz bulunmamaktadır.
                            </div>
                            }
                            <div class="accordion" id="orders">
                                @foreach (var order in Model)
                                {
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                            data-bs-target="#order_@order.Id">
                                            Sipariş No: #@order.Id
                                        </button>
                                    </h2>
                                    <div id="order_@order.Id" class="accordion-collapse collapse p-3 show"
                                        data-bs-parent="#orders">
                                        <table class="table table-bordered  mb-0">
                                            <tr>
                                                <td colspan="2">
                                                    Sipariş Tarihi
                                                </td>
                                                <td colspan="3">
                                                    @order.OrderDate.ToString("dd.MM.yyyy HH:mm")
                                                </td>
                                            </tr>
                                            <tr>
                                                <td colspan="2">
                                                    Ad Soyad
                                                </td>
                                                <td colspan="3">
                                                    @order.ReceiverFullName
                                                </td>
                                            </tr>
                                            <tr>
                                                <td colspan="2">
                                                    Teslimat Adresi
                                                </td>
                                                <td colspan="3">
                                                    @order.Address / @order.City / @order.PostalCode / @order.Phone
                                                </td>
                                            </tr>

                                            @foreach (var item in order.OrderItems)
                                            {
                                            <tr>
                                                <td style="width: 80px;">
                                                    <img src="~/img/@item.Product.Image" class="img-fluid"
                                                        alt="@item.Product.ProductName">
                                                </td>
                                                <td>@item.Product.ProductName</td>
                                                <td>@item.UnitPrice ₺</td>
                                                <td>@item.Quantity <span>adet</span></td>
                                                <td>@item.TotalPrice ₺</td>
                                            </tr>
                                            }
                                            <tr>
                                                <td colspan="3"></td>
                                                <td>Ara Toplam</td>
                                                <td>@order.SubTotal ₺</td>
                                            </tr>
                                            <tr>
                                                <td colspan="3"></td>
                                                <td>Vergi (%20)</td>
                                                <td>@order.Tax ₺</td>
                                            </tr>
                                            <tr>
                                                <td colspan="3"></td>
                                                <td>Kargo</td>
                                                <td>
                                                    @if(@order.ShippingFee != 0){
                                                    <span>@order.ShippingFee ₺</span>
                                                    }
                                                    else
                                                    {
                                                    <span>Ücretsiz</span>
                                                    }
                                                </td>
                                            </tr>
                                            <tr>
                                                <td colspan="3"></td>
                                                <td>Toplam</td>
                                                <td>@order.Total ₺</td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    @section Scripts
    {
    @await Html.PartialAsync("_ValidationScriptsPartial")
    }